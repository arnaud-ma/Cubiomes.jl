using Cubiomes
using Test

@testset "Noise" begin
    @testset "Perlin" begin
    #!format: off
    perlin_test = Cubiomes.Perlin(
        UInt8[
            70 , 234, 61 , 86 , 42 , 181, 32 , 253, 252, 26 , 22 , 191, 175, 210, 90 , 141,
            4  , 177, 207, 199, 238, 104, 41 , 51 , 170, 73 , 206, 48 , 129, 127, 254, 74 ,
            249, 95 , 57 , 66 , 59 , 9  , 219, 144, 143, 246, 65 , 33 , 6  , 83 , 174, 44 ,
            88 , 245, 115, 225, 145, 203, 25 , 120, 208, 235, 84 , 55 , 94 , 49 , 71 , 216,
            3  , 50 , 89 , 31 , 121, 195, 126, 91 , 233, 160, 244, 213, 99 , 242, 169, 124,
            7  , 23 , 63 , 163, 62 , 142, 109, 167, 231, 147, 209, 247, 82 , 135, 85 , 75 ,
            188, 173, 43 , 68 , 193, 60 , 93 , 98 , 101, 38 , 80 , 200, 239, 58 , 248, 5  ,
            46 , 140, 21 , 172, 194, 13 , 0  , 134, 202, 139, 251, 171, 152, 114, 39 , 227,
            197, 111, 106, 198, 105, 30 , 14 , 12 , 137, 110, 166, 123, 1  , 132, 122, 67 ,
            190, 150, 157, 162, 185, 112, 186, 17 , 182, 146, 212, 236, 196, 35 , 201, 87 ,
            10 , 165, 34 , 230, 220, 97 , 64 , 28 , 54 , 153, 113, 138, 119, 24 , 176, 96 ,
            226, 69 , 214, 178, 40 , 149, 79 , 78 , 168, 159, 154, 77 , 116, 37 , 237, 179,
            29 , 205, 255, 229, 11 , 118, 158, 125, 148, 217, 189, 107, 133, 36 , 180, 117,
            204, 155, 211, 128, 215, 52 , 15 , 45 , 76 , 240, 192, 20 , 224, 47 , 184, 103,
            16 , 223, 56 , 8  , 161, 92 , 18 , 241, 221, 100, 53 , 183, 151, 243, 250, 187,
            130, 218, 136, 222, 131, 108, 164, 156, 81 , 72 , 102, 2  , 19 , 228, 232, 27 , #stop
            70 ],

    #!format: on
            186.25630208841423,
            174.90520877052043,
            79.0321805651609,
            0.9052087705204315,
            0xae,
            0.9926477865806907,
            1.0,
            1.0,
        )

        seed = 42
        rng = Cubiomes.JavaRandom(seed)
        rng2 = copy(rng)
        perlin = Cubiomes.Noise(Cubiomes.Perlin, undef)
        Cubiomes.set_rng!🎲(perlin, rng)
        perlin2 = Cubiomes.Noise🎲(Cubiomes.Perlin, rng2)
        @test perlin == perlin_test
        @test perlin2 == perlin_test

        @test sample_noise(
            perlin, 11245.15955804693, -67684.5458000477, 37576.22769703678
        ) == -0.012774734959962033
    end
end